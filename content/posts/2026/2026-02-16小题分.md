---
title: 用Codex，半小时重构了小题分程序
description: 试用OpenAI最新的Codex模型，顺便重构了去年做的小题分拆分程序
date: 2026-02-16 11:55:20
updated: 2026-02-16 11:55:20
image: https://img.dino.236668.xyz/file/1771384513986_codex_banner.png
permalink: /posts/f3790f0
categories: [代码]
tags: [Python, Codex, GPT]
---

为了简化每次考试之后的小题分拆分工作，我去年借`qwen3-coder`模型辅助我开发了一个基于Python的程序。在这一个学期的使用中，还发现了一些还可以优化的地方，又因为之前做的很混乱，所以这次直接让Codex从零开始开发。

## 需求

从阅卷系统中导出的成绩表是这样的：每个学科一个Excel文件，其中包含参加本学科考试的所有学生分数（以及各个小题得分）

现在需要制作成这样的结构：每个班级一个表格，表格内每个学科是一个sheet，每个sheet内有本学科本班级学生的分数（以及各个小题得分）

之前都需要在Excel中，对每个学科的文件都先排序，然后筛选出本班级的学生，再转移到新的文件中，需要重复六七次，非常繁琐且麻烦，所以我上学期让千问写了一个Python程序用于处理成绩表

## 使用体验

上个学期一共有四次考试，所以这四次的小题分我都是用这个程序进行处理的，速度很快，数据也没有问题，没有出现分数与学生不对应的问题，但还是有些需要改进的地方：

- 表格没有内外边框，打印出来可读性不高，需要有引导线辅助阅读
- 不能选择部分班级导出，每次都会输出所有班级的数据
- 不能批量删除“班级”、“客观题得分”这种不需要的列，每个学科都需要手动删除很麻烦

## 重构

放寒假之后，我打算再用千问模型优化一下，但是发现VSCode内集成了OpenAI的Codex模型，于是便它从零开始重做了一下这个程序

GPT的编码能力很强，写出的代码基本没有跑不通的地方，现在可以直接在IDE使用官方的Agent，出来的效果也是更好了。并且GPT较新的模型做出的UI很好看，不再是一股AI味的蓝紫配色，我指定shadcn风格让它做，下面是做出的效果

![image-20260224201159239](https://img.dino.236668.xyz/file/1771935127711_image-20260224201159239.png)

![image-20260224201230326](https://img.dino.236668.xyz/file/1771935155608_image-20260224201230326.png)

至此大功告成，Codex免费额度给的也算充足，我做这个程序用了十几次对话，也只消耗了8%的额度